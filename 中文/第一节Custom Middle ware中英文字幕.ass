[Script Info]
; Script generated by Aegisub 3.2.2
; http://www.aegisub.org/
Title: Default Aegisub file
ScriptType: v4.00+
WrapStyle: 0
ScaledBorderAndShadow: yes
YCbCr Matrix: TV.601
PlayResX: 1280
PlayResY: 720

[Aegisub Project Garbage]
Last Style Storage: Default
Audio File: ../../Downloads/第一节.mp4
Video File: ../../Downloads/第一节.mp4
Video AR Mode: 4
Video AR Value: 1.777778
Video Zoom Percent: 0.750000
Scroll Position: 6
Active Line: 10
Video Position: 3698

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: 26字体,Arial,28,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,2,2,2,10,10,10,1
Style: Default,Arial,32,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,2,2,2,10,10,10,1

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
Dialogue: 0,0:00:01.05,0:00:02.04,Default,,0,0,0,,我是john dalloway\NI am john dalloway
Dialogue: 0,0:00:02.22,0:00:03.18,Default,,0,0,0,,我是geoff ricketts，\Nand I'm geoff ricketts,
Dialogue: 0,0:00:03.69,0:00:05.82,Default,,0,0,0,,我们将在这节课中讨论\Nso we're going to be talking in this session about
Dialogue: 0,0:00:05.97,0:00:09.27,Default,,0,0,0,,中间件自定义中间件深入到中间件内部\Nmiddleware custom middleware digging into some middleware internals
Dialogue: 0,0:00:09.36,0:00:09.66,Default,,0,0,0,,是的\Nyeah
Dialogue: 0,0:00:09.69,0:00:10.83,Default,,0,0,0,,中间件就像是一种游戏\Nmiddleware feels like a game
Dialogue: 0,0:00:10.86,0:00:11.91,Default,,0,0,0,,时髦词\Nof buzzword
Dialogue: 0,0:00:12.00,0:00:12.48,Default,,0,0,0,,确实如此\Nit does
Dialogue: 0,0:00:12.78,0:00:13.26,Default,,0,0,0,,你知道，\Nyou know,
Dialogue: 0,0:00:13.83,0:00:17.43,Default,,0,0,0,,但是当我越来越的深入了解他的peanut core时我意识到\Nbut once I started digging into his peanut core more and more I realize
Dialogue: 0,0:00:17.43,0:00:20.00,Default,,0,0,0,,所有的东西都是中间件，真的很强大\Neverything's middleware and that's where all the real power is
Dialogue: 0,0:00:20.00,0:00:25.40,Default,,0,0,0,,你知道所有可配置的事情，比如配置认证 你所知道的路由，\Nyou know everything you configure authentication and we see all the you know routing,
Dialogue: 0,0:00:26.25,0:00:28.50,Default,,0,0,0,,这就是所有事情都联系在一起的地方\Nthat's where everything's wired up in
Dialogue: 0,0:00:28.53,0:00:29.94,Default,,0,0,0,,很酷的一点是，\Nthe cool thing with that is,
Dialogue: 0,0:00:30.30,0:00:33.10,Default,,0,0,0,,您可以插入中间件\Nyou can plug-in the middleware
Dialogue: 0,0:00:33.10,0:00:34.20,Default,,0,0,0,,有很多原因，但其中一个是\Nis great for a lot of reasons but one is
Dialogue: 0,0:00:34.41,0:00:36.87,Default,,0,0,0,,你可以插入到这个堆栈，你可以说\Nyou can plug into this stack right and so you can say
Dialogue: 0,0:00:37.11,0:00:41.25,Default,,0,0,0,,在这个前面或这后面添加我的中间件，我可以完全控制它\Nadd my middleware after this one before this one I can completely control it
Dialogue: 0,0:00:41.28,0:00:42.24,Default,,0,0,0,,我可以调试它\NI can debug it
Dialogue: 0,0:00:43.23,0:00:44.25,Default,,0,0,0,,我可以自己写\Nand I can write my own
Dialogue: 0,0:00:44.46,0:00:45.06,Default,,0,0,0,,当然。\Nabsolutely.
Dialogue: 0,0:00:45.39,0:00:46.92,Default,,0,0,0,,让我们看一看写一些中间件\Nlet's take a look at writing some of word.
Dialogue: 0,0:00:47.04,0:00:47.49,Default,,0,0,0,,好吧\Nall right
Dialogue: 0,0:00:47.94,0:00:49.23,Default,,0,0,0,,在我的机器上。\Nso here on my machine.
Dialogue: 0,0:00:49.80,0:00:53.80,Default,,0,0,0,,我有一个空的asp.net core 程序\NI have a empty asp,net core application
Dialogue: 0,0:00:53.88,0:00:57.00,Default,,0,0,0,,这只是在这一点上配置了一些基础\Nthat just has some of the basics configured at this point.
Dialogue: 0,0:00:57.51,0:01:00.33,Default,,0,0,0,,好吧，我的起始课上没有任何改动，\Nok there's nothing going on in my startup class,
Dialogue: 0,0:01:01.02,0:01:01.40,Default,,0,0,0,,并且\Nand
Dialogue: 0,0:01:01.40,0:01:01.41,Default,,0,0,0,,现在我有一个配置方法\NI have a configure method here tonight\N并且\Nand
Dialogue: 0,0:01:01.41,0:01:03.90,Default,,0,0,0,,现在我有一个配置方法\NI have a configure method here tonight
Dialogue: 0,0:01:03.90,0:01:05.80,Default,,0,0,0,,我正在访问日志工厂\NI am accessing the logger factory,
Dialogue: 0,0:01:05.82,0:01:08.01,Default,,0,0,0,,这样我就可以创建一个日志记录器了。\Njust so that I can create a logger.
Dialogue: 0,0:01:08.28,0:01:10.47,Default,,0,0,0,,所以它可以开始与我的日志进行交互\Nso it can start to interact with my log
Dialogue: 0,0:01:10.50,0:01:12.18,Default,,0,0,0,,当我在构建我的应用程序时。\Nas I'm building my application.
Dialogue: 0,0:01:12.81,0:01:14.10,Default,,0,0,0,,我之前做过的另一件事\Nthe one other thing that I've done
Dialogue: 0,0:01:14.49,0:01:16.23,Default,,0,0,0,,我已经进入我的项目了。\Nis I've gone into my project.
Dialogue: 0,0:01:16.80,0:01:22.80,Default,,0,0,0,,就像我在视频中做的关于授权的视频一样\Nand just like I did when we worked on our video about authorization
Dialogue: 0,0:01:22.92,0:01:25.05,Default,,0,0,0,,我已经激活了dotnet watcher\NI've activated the dotnet watcher
Dialogue: 0,0:01:25.20,0:01:26.49,Default,,0,0,0,,在我的应用程序中\Ninside of my application
Dialogue: 0,0:01:26.70,0:01:34.00,Default,,0,0,0,,通过添加一行DotNetCliToolReference Include  microsoft dot net watcher tools version=2.0\Nby adding this line DotNetCliToolReference Include microsoft dot net watcher tools version=2.0
Dialogue: 0,0:01:34.00,0:01:42.00,Default,,0,0,0,,这将让在我的C#代码中有改动时都重新运行我的应用程序\Nand this will let me rerun my application every time there's a c sharp change inside my code that I save
Dialogue: 0,0:01:42.33,0:01:42.66,Default,,0,0,0,,好的\Nokay
Dialogue: 0,0:01:43.00,0:01:45.20,Default,,0,0,0,,如果我现在运行这个应用程序。\Nso if I run this application right now.
Dialogue: 0,0:01:48.70,0:01:51.10,Default,,0,0,0,,我输入dotnet watch run.\NI'll say dot net watch run.
Dialogue: 0,0:01:51.15,0:01:54.87,Default,,0,0,0,,这将运行我的应用程序并开始观察它以确保\Nso this will run my application and start watching it to make sure
Dialogue: 0,0:01:55.26,0:01:57.54,Default,,0,0,0,,如果有任何变化，它会重新启动，\Nthat it restarts if there are any changes,
Dialogue: 0,0:01:58.30,0:02:02.40,Default,,0,0,0,,它在监听这个位置的运行，\Nand there it is it's running in its listening on this location,
Dialogue: 0,0:02:02.76,0:02:04.20,Default,,0,0,0,,我将复制它\Nso I will copy that
Dialogue: 0,0:02:04.71,0:02:06.60,Default,,0,0,0,,我将到我的浏览器，\Nand I'll come over here to my browser,
Dialogue: 0,0:02:06.93,0:02:08.40,Default,,0,0,0,,导航到那个位置\Nnavigate to that location
Dialogue: 0,0:02:08.43,0:02:09.51,Default,,0,0,0,,然后我就得到\Nand I just get
Dialogue: 0,0:02:10.32,0:02:11.13,Default,,0,0,0,,hello world,\Nhello world,
Dialogue: 0,0:02:11.31,0:02:11.64,Default,,0,0,0,,好的，\Nokay,
Dialogue: 0,0:02:12.15,0:02:13.68,Default,,0,0,0,,现在我得到了hello world\Nnow I get hello world
Dialogue: 0,0:02:14.04,0:02:15.70,Default,,0,0,0,,因为在这个配置方法中\Nbecause in this configure method
Dialogue: 0,0:02:15.70,0:02:15.72,Default,,0,0,0,,我在这里配置我的中间件，最后这个应用程序运行\Nwhere I configure my middleware. the last thing that happens is this app run\N因为在这个配置方法中\Nbecause in this configure method
Dialogue: 0,0:02:15.72,0:02:20.70,Default,,0,0,0,,我在这里配置我的中间件，最后这个应用程序运行\Nwhere I configure my middleware. the last thing that happens is this app run
Dialogue: 0,0:02:21.24,0:02:21.84,Default,,0,0,0,,并且\Nand
Dialogue: 0,0:02:22.50,0:02:26.60,Default,,0,0,0,,无论上下文是什么，我们都要将内容类型改为HTML\Nwhatever the context is， we're going to change the content type to HTML
Dialogue: 0,0:02:26.97,0:02:28.62,Default,,0,0,0,,我们将输出hello world。\Nand we're going to output hello world.
Dialogue: 0,0:02:29.07,0:02:29.70,Default,,0,0,0,,这是\Nso this is
Dialogue: 0,0:02:29.70,0:02:34.60,Default,,0,0,0,,这实际上是非常疯狂的你只需要几行代码就可以浏览网页\Nthis is actually pretty crazy you've got in just a few lines of code you're  surfing web requests
Dialogue: 0,0:02:34.89,0:02:37.14,Default,,0,0,0,,我用html服务web请求。\NI'm serving web request with html.
Dialogue: 0,0:02:37.50,0:02:43.20,Default,,0,0,0,,但是我想指出的是这行运行语句是一个终端中间件，\Nbut what I want to point out here is this run statement is a terminating piece of Middleware,
Dialogue: 0,0:02:43.30,0:02:50.00,Default,,0,0,0,,好的，在这之后我们实际上不会传递到另一个项目\NOK, We don't actually pass on to another item after this occurs
Dialogue: 0,0:02:50.50,0:02:53.20,Default,,0,0,0,,好了，这是链条的末端什么也没有发生\NOK, This is the end of the chain nothing more happens
Dialogue: 0,0:02:53.40,0:02:57.40,Default,,0,0,0,,这是我们在使用MVC时所看到的\Nand this is typically what we'll see when we see that use MVC
Dialogue: 0,0:02:57.75,0:03:00.57,Default,,0,0,0,,在我们的中间件内部，这是一个终端\Ninside of our Middleware,right that's a terminating piece
Dialogue: 0,0:03:00.70,0:03:06.20,Default,,0,0,0,,尽管它在使用的是MVC\Neven though it's using， the phrase use， it use MVC
Dialogue: 0,0:03:06.20,0:03:09.50,Default,,0,0,0,,你可以继续做一些事情\Nyou could continue on have something after it but
Dialogue: 0,0:03:09.70,0:03:13.10,Default,,0,0,0,,按照惯例，在这之后没有任何事情发生，\Nby convention run says there's nothing that occurs after this,
Dialogue: 0,0:03:13.20,0:03:15.20,Default,,0,0,0,,这就是它的最后，好吧，\NThis is the end of it, OK,
Dialogue: 0,0:03:15.60,0:03:18.20,Default,,0,0,0,,这是终止，\NSo this is terminating,
Dialogue: 0,0:03:18.20,0:03:28.10,Default,,0,0,0,,还有一些其他的东西比如app.usestaticfiles，好的，这将会传递到控制\Nnow other ones that we have other things like app.useStaticFiles，Alright So this will pass on control
Dialogue: 0,0:03:28.40,0:03:32.10,Default,,0,0,0,,如果有些东西不知道如何回应，\Nif there are things that it doesn't know how to respond to,
Dialogue: 0,0:03:32.20,0:03:37.10,Default,,0,0,0,,所以，如果有人提出了请求一个在磁盘上的静态文件，\NSo, if somebody's made a request for what it finds is a static file on disk,
Dialogue: 0,0:03:37.40,0:03:40.50,Default,,0,0,0,,它将处理静态文件和停止处理，\Nit'll serve that static file and stop processing,
Dialogue: 0,0:03:41.00,0:03:44.30,Default,,0,0,0,,在运行语句之前，我把它放在这里很重要，\NAnd it's important that I put that in before the run statement,
Dialogue: 0,0:03:44.73,0:03:46.53,Default,,0,0,0,,因为我想确保\Nbecause I want to make sure that
Dialogue: 0,0:03:46.98,0:03:48.84,Default,,0,0,0,,我们并不是总能得到一个hello world\Nwe don't always get a hello world
Dialogue: 0,0:03:49.00,0:03:53.10,Default,,0,0,0,,当我为我的请求服务时，我有一个index.html，我把它写到磁盘上，\NWhen I serve my request now I have an Index.HTML that I wrote to disk,
Dialogue: 0,0:03:53.40,0:03:56.00,Default,,0,0,0,,它只从index.html中显示Hello，\Nthat just says Hello from index html,
Dialogue: 0,0:03:56.10,0:04:01.10,Default,,0,0,0,,如果我浏览到/index.html\NIf I browse to slash index.html
Dialogue: 0,0:04:01.47,0:04:03.24,Default,,0,0,0,,我从index.html中得到hello\NI get hello from index.html,
Dialogue: 0,0:04:03.70,0:04:05.70,Default,,0,0,0,,如果我不去那个页面\Nif I don't go to that page
Dialogue: 0,0:04:05.90,0:04:08.50,Default,,0,0,0,,如果我去别的地方\Nif I go somewhere else
Dialogue: 0,0:04:08.90,0:04:12.40,Default,,0,0,0,,我仍然能得到Hello World 所以你说的顺序真的很重要\NI still get Hello World  so that order like you're saying really matters
Dialogue: 0,0:04:12.50,0:04:16.50,Default,,0,0,0,,因为如果在use MVC后，它将为提供你的静态文件\Nbecause if that serves you static files was after the use MVC
Dialogue: 0,0:04:16.90,0:04:20.30,Default,,0,0,0,,让我们试试，我要用Alt+Down来移动它\Nlet's try yeah I'm going to move it down using Alt+Down
Dialogue: 0,0:04:20.40,0:04:23.50,Default,,0,0,0,,把它放在我的run语句之后，\Nand put it after my run statement,
Dialogue: 0,0:04:24.12,0:04:25.74,Default,,0,0,0,,现在让我们回到浏览器。\Nso now let me go back to the browser.
Dialogue: 0,0:04:26.70,0:04:30.70,Default,,0,0,0,,它会输出Hello World尽管我已经请求了index.html\Nand it says Hello World even though I've requested index.html
Dialogue: 0,0:04:30.80,0:04:34.20,Default,,0,0,0,,那是因为它知道是提供 index.html，\Nthat's because it knows to serve index.html,
Dialogue: 0,0:04:34.40,0:04:39.40,Default,,0,0,0,,在它指定终端后它会输出 hello world\NAfter it specifies that terminating endpoint where it saying hello world
Dialogue: 0,0:04:39.50,0:04:46.00,Default,,0,0,0,,这给了我很大的权力和灵活性来说这就是我想要的使用中间件的顺序\NSo that gives me a lot of power and flexibility to say this is exactly the order of how I want my middleware process
Dialogue: 0,0:04:46.00,0:04:46.80,Default,,0,0,0,,当然。\Nabsolutely.
Dialogue: 0,0:04:47.30,0:04:59.50,Default,,0,0,0,,好了，现在我们回到这里，我要做的是，我要用app.usestaticfile,\NAlright, so now let's go back over here and that's， I'll do app.usestaticfile,
Dialogue: 0,0:04:59.60,0:05:06.70,Default,,0,0,0,,好了，现在我可以开始写我自己的use语句来做其他事情\NThere we go. now I can start to write my own use statements here to do other things
Dialogue: 0,0:05:06.70,0:05:09.80,Default,,0,0,0,,做对我的管道很重要的事情\Ndo other things that are important with my pipeline
Dialogue: 0,0:05:09.90,0:05:11.20,Default,,0,0,0,,我的请求管道，\Nmy request pipeline,
Dialogue: 0,0:05:11.40,0:05:14.20,Default,,0,0,0,,让我们来做一些实际的事情\NSo let's do something here where we'll actually
Dialogue: 0,0:05:14.40,0:05:17.40,Default,,0,0,0,,将环境信息输出到我们的日志\Noutput the environment information to our log
Dialogue: 0,0:05:17.50,0:05:23.40,Default,,0,0,0,,所以我要写应用app.use  可以在这里放一个匿名函数\NSo I will write app dot use and I can put an anonymous statement in here,
Dialogue: 0,0:05:23.66,0:05:27.29,Default,,0,0,0,,这样它就会在每个请求后执行\Nso that it actually goes through and executes this on every request
Dialogue: 0,0:05:27.40,0:05:31.60,Default,,0,0,0,,好的，我们需要使用的格式是async\NOkay! So the format we need to use is async
Dialogue: 0,0:05:32.10,0:05:36.30,Default,,0,0,0,,一些上下文，然后是next =>\Nsome context and then a next pointer
Dialogue: 0,0:05:36.50,0:05:39.90,Default,,0,0,0,,我们要求的下一个功能是什么，\Nto what's going to be the next feature that we request,
Dialogue: 0,0:05:42.00,0:05:48.50,Default,,0,0,0,,好了，现在我可以直接和管道进行交互了，\NAlright! And now I can interact with the pipeline directly as it's being walked through,
Dialogue: 0,0:05:48.70,0:05:48.70,Default,,0,0,0,,我将写入日志记录器，日志信息\Nso I will say logger,log information
Dialogue: 0,0:05:49.22,0:05:51.77,Default,,0,0,0,,所以我说logger.loginformation.\Nso I will say log dot log information.
Dialogue: 0,0:05:51.80,0:06:02.40,Default,,0,0,0,,我可以说beginning request in this EnvironmentName\Nand I can say beginning request in this EnvironmentName
Dialogue: 0,0:06:02.80,0:06:08.00,Default,,0,0,0,,好的，这就会把信息记录下来\NOK   all right， and that'll log that information out for me
Dialogue: 0,0:06:08.20,0:06:15.10,Default,,0,0,0,,当有一个请求时，我编译完成后，我将请求这个页面\Nwhen there's a request， so my compile is finished， I'll request this page
Dialogue: 0,0:06:15.20,0:06:19.10,Default,,0,0,0,,实际上它并没有返回任何东西，\Nand it actually didn't return anything,
Dialogue: 0,0:06:19.13,0:06:21.98,Default,,0,0,0,,但是我得到了我的开始请求声明\NBut I'm getting my beginning request statement written out,
Dialogue: 0,0:06:22.00,0:06:24.40,Default,,0,0,0,,为什么它没有返回任何东西？\NWhy didn't it return anything?
Dialogue: 0,0:06:24.70,0:06:30.50,Default,,0,0,0,,因为我的use语句是通过HTTP上下文传递信息的\NBecause my use statement here is being passed in information by HTTP context
Dialogue: 0,0:06:30.50,0:06:34.00,Default,,0,0,0,,这是被执行的，\Nthat's being executed,
Dialogue: 0,0:06:34.04,0:06:35.36,Default,,0,0,0,,所以你需要告诉它，\Nso you actually need to tell it,
Dialogue: 0,0:06:36.20,0:06:38.90,Default,,0,0,0,,做下一件事，好，我们来完成他，\NGo to the next thing. okay, so let's do that,
Dialogue: 0,0:06:39.20,0:06:45.50,Default,,0,0,0,,现在我可以说，await nex( )，它将执行管道中的下一个项目。\NSo now I can say  await next and it'll execute the next item in the pipeline.
Dialogue: 0,0:06:46.22,0:06:47.45,Default,,0,0,0,,我保存一下\Nso I'll save that
Dialogue: 0,0:06:48.62,0:06:51.17,Default,,0,0,0,,我要确保它在这里重新启动\NI'll make sure that it finishes restarting here
Dialogue: 0,0:06:51.80,0:06:53.03,Default,,0,0,0,,让我回到浏览器\Nlet me come back to my browser
Dialogue: 0,0:06:53.27,0:06:53.87,Default,,0,0,0,,现在\Nand now
Dialogue: 0,0:06:53.90,0:06:55.07,Default,,0,0,0,,当我请求这个的时候\Nwhen I request this
Dialogue: 0,0:06:55.31,0:06:56.96,Default,,0,0,0,,我从index.html中得到hello\NI get hello from index html
Dialogue: 0,0:06:57.17,0:06:59.27,Default,,0,0,0,,因为这是管道的下一部分\Nbecause that's the next piece in the pipeline
Dialogue: 0,0:06:59.50,0:07:03.90,Default,,0,0,0,,如果我在我的日志中查看，我得到了 “beginning requests in development”\Nand if I look over here in my log， I get beginning requests in development
Dialogue: 0,0:07:04.00,0:07:06.30,Default,,0,0,0,,然后我看到它提供了静态文件\Nand then I see it served the static file
Dialogue: 0,0:07:06.53,0:07:06.89,Default,,0,0,0,,很好\Ngreat
Dialogue: 0,0:07:06.95,0:07:07.40,Default,,0,0,0,,现在我可以说，等下它会执行\NSo now I can say  await next and it'll execute the
Dialogue: 0,0:07:07.40,0:07:07.43,Default,,0,0,0,,我们插入了一些信息，并我们处理静态文件\NSo we've inserted some information and we're processing that static file\N现在我可以说，等下它会执行\NSo now I can say  await next and it'll execute the
Dialogue: 0,0:07:07.43,0:07:12.80,Default,,0,0,0,,我们插入了一些信息，并我们处理静态文件\NSo we've inserted some information and we're processing that static file
Dialogue: 0,0:07:12.95,0:07:14.63,Default,,0,0,0,,然后我们再往前走一步，\Nand then we go one step further,
Dialogue: 0,0:07:14.99,0:07:16.49,Default,,0,0,0,,下一个语句\Nthat next statement
Dialogue: 0,0:07:16.97,0:07:19.67,Default,,0,0,0,,正在被执行，我仍然可以执行其他的事情。\Nis being executed and I can still execute other things.
Dialogue: 0,0:07:20.10,0:07:23.40,Default,,0,0,0,,在其他事情结束后，\Nafter those other things finish,
Dialogue: 0,0:07:23.54,0:07:25.64,Default,,0,0,0,,这让我有了更大的灵活性\NSo that gives me the flexibility to say
Dialogue: 0,0:07:25.80,0:07:29.50,Default,,0,0,0,,调用这个——调用这个你完成了中间件的执行\Ncall that-- call this you complete executing the middleware
Dialogue: 0,0:07:29.60,0:07:31.60,Default,,0,0,0,,但我想要最后的决定权，\Nbut I want the final say after that,
Dialogue: 0,0:07:31.70,0:07:32.50,Default,,0,0,0,,当然。\Nabsolutely.
Dialogue: 0,0:07:32.50,0:07:34.50,Default,,0,0,0,,如果我在这里设置一个计时器呢\Nso what if I set up a timer here
Dialogue: 0,0:07:35.06,0:07:36.17,Default,,0,0,0,,当我做完了，\Nand when I'm done,
Dialogue: 0,0:07:36.20,0:07:41.00,Default,,0,0,0,,我可以说logger.loginformation\NI can say logger.loginformation
Dialogue: 0,0:07:41.00,0:07:41.66,Default,,0,0,0,,就是这样\Nthere it is
Dialogue: 0,0:07:42.47,0:07:43.61,Default,,0,0,0,,我可以说。\Nand I can say.
Dialogue: 0,0:07:44.03,0:07:45.86,Default,,0,0,0,,当你在打字的时候\Nand as you're typing that you're using
Dialogue: 0,0:07:46.20,0:07:49.30,Default,,0,0,0,,最近添加到C#的字符串插值特性\Nthe string interpolation feature which was added to C sharp recently
Dialogue: 0,0:07:49.40,0:07:52.20,Default,,0,0,0,,我真的很喜欢这是一开始的美元符号\NI really like that that's the dollar sign at the beginning
Dialogue: 0,0:07:53.60,0:07:57.20,Default,,0,0,0,,然后是花括号它允许将代码插入到字符串中，\Nand then the curly braces and it allows inserting code into a string,
Dialogue: 0,0:07:57.20,0:08:00.00,Default,,0,0,0,,将代码插入到字符串中，是的，我可以格式化我的字符串\Ninserting code into a string. Yeah, I can format my string
Dialogue: 0,0:08:00.02,0:08:03.11,Default,,0,0,0,,不需要使用那些基于整数的格式化语句。\Nwithout having to use those integer based formatting statements.
Dialogue: 0,0:08:03.68,0:08:04.55,Default,,0,0,0,,所以我要\Nso I'm just going to
Dialogue: 0,0:08:04.88,0:08:08.00,Default,,0,0,0,,输出关于完成请求需要多长时间的信息，\Noutput the information about how long it took to complete the request,
Dialogue: 0,0:08:08.70,0:08:13.80,Default,,0,0,0,,我将验证我的应用程序已经完成了重建和重新启动\Nso I'll verify that my application has finished rebuilding and restarting over here
Dialogue: 0,0:08:14.45,0:08:16.31,Default,,0,0,0,,我将再次请求我的页面\Nand I'll request my page again
Dialogue: 0,0:08:17.36,0:08:18.59,Default,,0,0,0,,如果我看一下我的日志。\Nif I look at my log.
Dialogue: 0,0:08:18.95,0:08:20.03,Default,,0,0,0,,你可以看到这里\Nyou can see here
Dialogue: 0,0:08:20.87,0:08:22.40,Default,,0,0,0,,在开发中开始请求，\Nbeginning request in development,
Dialogue: 0,0:08:22.73,0:08:24.41,Default,,0,0,0,,它服务于静态文件。\Nit served the static file.
Dialogue: 0,0:08:24.47,0:08:25.58,Default,,0,0,0,,它没有被修改\Nit wasn't modified
Dialogue: 0,0:08:25.88,0:08:28.04,Default,,0,0,0,,在9毫秒内完成了请求。\Ncompleted the request in nine milliseconds.
Dialogue: 0,0:08:28.30,0:08:34.70,Default,,0,0,0,,现在我已经得到了所有这些信息，我可以插入和操作我的请求\NSo I've got all this information now that I'm able to insert and manipulate around my requests
Dialogue: 0,0:08:34.80,0:08:38.30,Default,,0,0,0,,通过在这里写一小段中间件。\Nby writing a little piece of middleware right here.
Dialogue: 0,0:08:38.48,0:08:41.93,Default,,0,0,0,,这是一个use语句\NNow that's a used statement
Dialogue: 0,0:08:42.10,0:08:44.80,Default,,0,0,0,,使用的是context 和next item把他传递到了控制器\Nthe used has takes the context and the next item  so it passes on control
Dialogue: 0,0:08:45.05,0:08:47.24,Default,,0,0,0,,最终结束了中间件\Nand I effectively end up wrapping the middleware
Dialogue: 0,0:08:47.40,0:08:50.80,Default,,0,0,0,,我可以在它跳转回来的时候执行\Nand I'm able to execute things as it comes back up
Dialogue: 0,0:08:51.00,0:08:55.00,Default,,0,0,0,,并取消请求，因为这已经完成了。\Nand unwinds the request because these other things have completed.
Dialogue: 0,0:08:55.80,0:08:59.80,Default,,0,0,0,,现在，我可以在这里做其他的事情，比如映射\NNow, I can do other things in here like mapping
Dialogue: 0,0:09:00.20,0:09:03.40,Default,,0,0,0,,现在映射是我想要分支请求的时候\Nnow mapping is when I want to branch the requests
Dialogue: 0,0:09:03.50,0:09:07.80,Default,,0,0,0,,当某件事发生的时候我会做一些不同的事情\NI'm going to do something different when a certain thing occurs
Dialogue: 0,0:09:07.90,0:09:12.60,Default,,0,0,0,,当我遇到一个确定的标准时，当我满足某个条件的时候\Nall right when I meet a certain， when I meet a certain criteria
Dialogue: 0,0:09:12.70,0:09:18.60,Default,,0,0,0,,好的，最简单的格式是匹配一条路径\Nokay, so the simplest format of this is to match a path
Dialogue: 0,0:09:18.80,0:09:22.40,Default,,0,0,0,,所以我可以匹配一些简单的东西\Nso I could match something as simple as contacts
Dialogue: 0,0:09:22.50,0:09:24.70,Default,,0,0,0,,如果有人请求联系页面\Nif somebody requests the contacts page
Dialogue: 0,0:09:25.16,0:09:27.32,Default,,0,0,0,,你想做什么你想做什么\Nwhat do you want to do what do you want that
Dialogue: 0,0:09:28.10,0:09:29.90,Default,,0,0,0,,对于类似的使用或运行语句。\Nto a similar type of use or run statement.
Dialogue: 0,0:09:30.10,0:09:33.00,Default,,0,0,0,,对于类似的使用或运行语句。\Nto a similar type of use or run statement.
Dialogue: 0,0:09:33.14,0:09:34.16,Default,,0,0,0,,我们来做一下。\Nso let's do that.
Dialogue: 0,0:09:34.40,0:09:38.70,Default,,0,0,0,,我将把它传递给一个 run语句\NI will pass on to a run statement
Dialogue: 0,0:09:38.70,0:09:49.20,Default,,0,0,0,,这一次我说，async context，这里有另一个打印\Nand I will say async context and this time， there's another print there
Dialogue: 0,0:09:49.30,0:09:53.60,Default,,0,0,0,,这次我只说等待上下文响应\Nthis time I'll just say await context response
Dialogue: 0,0:09:54.00,0:09:59.90,Default,,0,0,0,,右边是你的联系人\Nright asynchronously here are your contacts right
Dialogue: 0,0:09:59.90,0:10:01.40,Default,,0,0,0,,也许我有一些代码\Nand perhaps I have some code
Dialogue: 0,0:10:01.70,0:10:04.60,Default,,0,0,0,,这将输出一些联系信息。\Nthat is going to output some contact information.
Dialogue: 0,0:10:04.70,0:10:05.00,Default,,0,0,0,,好的，\Nokay,
Dialogue: 0,0:10:05.20,0:10:08.50,Default,,0,0,0,,但实际上，在这里，我在底层与这个请求进行交互\Nbut I'm really at a low level here interacting with that request
Dialogue: 0,0:10:08.50,0:10:10.50,Default,,0,0,0,,对一个非常具体的\Nresponding to a very specific
Dialogue: 0,0:10:10.60,0:10:14.60,Default,,0,0,0,,请求，是的，非常具体的格式\Nrequest. Yeah, very specific format and
Dialogue: 0,0:10:14.60,0:10:18.20,Default,,0,0,0,,这里没有mvc，没有razor视图没有控制器，\Nright there's no mvc here there's no razor views no controllers,
Dialogue: 0,0:10:18.51,0:10:21.96,Default,,0,0,0,,我直接在http请求中编写代码。\NI'm writing code directly against that http request.
Dialogue: 0,0:10:22.10,0:10:24.30,Default,,0,0,0,,好的，现在如果我来这里\NOkay, so now if I come in  here
Dialogue: 0,0:10:24.50,0:10:27.80,Default,,0,0,0,,我仍然可以请求index.html，我得到index.html\NI can still request index.html, and I get index.html
Dialogue: 0,0:10:27.90,0:10:34.80,Default,,0,0,0,,但是我有一个关于/联系人的映射声明。\Nbut I have that map statement for /Contacts.
Dialogue: 0,0:10:34.80,0:10:36.40,Default,,0,0,0,,所以如果我去contacts\NSo if I go to contacts,
Dialogue: 0,0:10:36.40,0:10:37.20,Default,,0,0,0,,我得到了这个，好的，对。\NI get that occurring. OK, right.
Dialogue: 0,0:10:37.20,0:10:39.90,Default,,0,0,0,,如果我去别的地方，如果我说联系人\NIf I go somewhere else if I say contacts
Dialogue: 0,0:10:40.00,0:10:43.00,Default,,0,0,0,,对于Jon来说，它在别的地方，\Nfor Jon it's somewhere else,
Dialogue: 0,0:10:43.60,0:10:44.70,Default,,0,0,0,,一直到这个过程\Nit falls all the way down to that run
Dialogue: 0,0:10:45.15,0:10:46.32,Default,,0,0,0,,它输出 hello world。\Nwhere it says hello world.
Dialogue: 0,0:10:46.47,0:10:46.77,Default,,0,0,0,,好的\Nok
Dialogue: 0,0:10:47.50,0:10:51.80,Default,,0,0,0,,现在我已经映射并跳转过来，因为我有匹配的路径\NSo now I've mapped and jumped off because I have path that matches
Dialogue: 0,0:10:51.80,0:10:53.90,Default,,0,0,0,,我还可以在这里添加其他条件。\NI can add other conditions in there too.
Dialogue: 0,0:10:54.60,0:10:56.60,Default,,0,0,0,,看看这个，我们再看一遍\NSo check this out. Let's go over
Dialogue: 0,0:10:56.70,0:10:58.50,Default,,0,0,0,,我想在这里再加一个检查，\NI want to add one more check in here,
Dialogue: 0,0:10:59.00,0:11:02.60,Default,,0,0,0,,我可以使用 app.Map when( )\NI can say app.Map when
Dialogue: 0,0:11:02.70,0:11:05.20,Default,,0,0,0,,我可以在这里检查一个特定的条件。\Nand I can check for a specific condition here.
Dialogue: 0,0:11:05.60,0:11:08.00,Default,,0,0,0,,所以我要讲一下我的上下文\NSo I'm going to take my context
Dialogue: 0,0:11:08.10,0:11:14.40,Default,,0,0,0,,我将写入context Request.Headers\Nand I'm going to say context Request.Headers
Dialogue: 0,0:11:14.70,0:11:16.60,Default,,0,0,0,,让我们检查一下我的user-agent\Nand let's check my user agent
Dialogue: 0,0:11:17.85,0:11:20.37,Default,,0,0,0,,因为也许我想对不同的浏览器有不同的表现，\Nbecause maybe I want to behave differently for different browsers,
Dialogue: 0,0:11:22.20,0:11:28.40,Default,,0,0,0,,我可以用contains（Firefox）\Nand I can say if that contains Firefox,
Dialogue: 0,0:11:30.87,0:11:32.88,Default,,0,0,0,,好了，我想指定其他的东西来做。\Nalright, I want to specify something else to do.
Dialogue: 0,0:11:33.10,0:11:36.00,Default,,0,0,0,,让我们创建一个火狐路由方法\NSo let's create a Firefox Route method
Dialogue: 0,0:11:36.50,0:11:39.60,Default,,0,0,0,,我创建这个方法\Nto call and I will create that method for me
Dialogue: 0,0:11:41.40,0:11:43.80,Default,,0,0,0,,我将向下滚动到这个。\Nand I'll scroll down to that.
Dialogue: 0,0:11:44.10,0:11:46.70,Default,,0,0,0,,这就接收到IApplicationBuilder\NSo this receives an IApplicationBuilder
Dialogue: 0,0:11:47.70,0:11:50.60,Default,,0,0,0,,我把它重命名为app，所以它看起来和我们的其他东西一样\NI'll rename it to app, so it looks like those other things that we have
Dialogue: 0,0:11:50.90,0:11:55.00,Default,,0,0,0,,在这个方法中，我可以做其他我想做的事情，\Nand in this method now I can actually do those other things that  I would want to do,
Dialogue: 0,0:11:55.80,0:11:59.50,Default,,0,0,0,,所以我们用app.Run（）\NSo let's say app.Run
Dialogue: 0,0:11:59.50,0:12:02.90,Default,,0,0,0,,我要再一次使用上下文环境，\Nand once again I'll do context,
Dialogue: 0,0:12:02.90,0:12:12.00,Default,,0,0,0,,当你输入的时候，你会想到的一个问题是你把它重构到另一个\Nas you're typing that one thing that comes to mind with this is because you're refactoring this out to another
Dialogue: 0,0:12:12.00,0:12:15.40,Default,,0,0,0,,在整个中间件列表中\Nout of that whole long list of MiddleWare
Dialogue: 0,0:12:15.40,0:12:20.50,Default,,0,0,0,,你把它重构到另一个方法我甚至可以把它放到另一个程序中\Nyou're refactoring it to another method and I could potentially even put this in another assembly
Dialogue: 0,0:12:20.60,0:12:22.70,Default,,0,0,0,,我可以把它放在Nuget包里或者别的什么，对吧。\NI could put it in a Nuget package or whatever ，right.
Dialogue: 0,0:12:22.90,0:12:25.70,Default,,0,0,0,,剧透警告！这就是我们接下来要做的。\NSpoiler alert! That's what we're going next.
Dialogue: 0,0:12:26.40,0:12:29.70,Default,,0,0,0,,好的，让我们看看这里我需要async\NRight, let's see I need async here
Dialogue: 0,0:12:31.70,0:12:34.80,Default,,0,0,0,,等着不要去那里，等着完成，\Nand await doesn't go there, await goes over,
Dialogue: 0,0:12:36.70,0:12:39.90,Default,,0,0,0,,这里，好了，现在我保存一下。\Nhere. Alright, so now I'll save that.
Dialogue: 0,0:12:40.14,0:12:42.96,Default,,0,0,0,,看一下这个发生的顺序。\NSo looking at the order in which this occurs.
Dialogue: 0,0:12:43.35,0:12:43.68,Default,,0,0,0,,对的\Nright
Dialogue: 0,0:12:43.70,0:12:45.80,Default,,0,0,0,,所以如果有人访问contacts，\NSo if somebody goes to contacts,
Dialogue: 0,0:12:45.80,0:12:48.90,Default,,0,0,0,,我们要异步写入 here are your contacts.\Nwe're going to write asynchronously here are your contacts
Dialogue: 0,0:12:48.90,0:12:51.70,Default,,0,0,0,,如果他们使用火狐，\NIf they go somewhere else and they're using Firefox,
Dialogue: 0,0:12:52.38,0:12:54.27,Default,,0,0,0,,我们要写Hello Firefox，好的。\Nwe're going to write out Hello Firefox. Alright.
Dialogue: 0,0:12:54.45,0:12:54.81,Default,,0,0,0,,好吧\Nright,
Dialogue: 0,0:12:55.30,0:12:57.90,Default,,0,0,0,,所以我要去/联系，\NSo I'll go to /contacts,
Dialogue: 0,0:12:58.56,0:12:59.64,Default,,0,0,0,,这是你的联系人。\Nhere are your contacts.
Dialogue: 0,0:12:59.94,0:13:01.74,Default,,0,0,0,,所以现在我要去别的地方。\Nso now I'll go somewhere else.
Dialogue: 0,0:13:04.80,0:13:06.06,Default,,0,0,0,,我得到了hello world。\NI'm getting hello world.
Dialogue: 0,0:13:06.27,0:13:07.56,Default,,0,0,0,,我做错了什么。\Nwhat did I do wrong there.
Dialogue: 0,0:13:09.30,0:13:13.30,Default,,0,0,0,,但是这已经发生。让我回去，让我们连接调试器\NSo here's what's going on, let me back up and let's attach the debugger
Dialogue: 0,0:13:13.30,0:13:15.50,Default,,0,0,0,,看看这里到底发生了什么。\Nand  look at and look at what exactly is going on here.
Dialogue: 0,0:13:15.78,0:13:17.04,Default,,0,0,0,,所以我要停止这个。\Nso I'm going to stop this.
Dialogue: 0,0:13:18.30,0:13:22.50,Default,,0,0,0,,停止我的监视 ，跳转到我的代码\NI'll stop my watch and I'm going to go over to my code
Dialogue: 0,0:13:22.60,0:13:26.50,Default,,0,0,0,,现在，如果我在MapWhen 语句上放一个断点\Nand now if I put a break point here on this MapWhen statement
Dialogue: 0,0:13:26.50,0:13:35.20,Default,,0,0,0,,好的， MapWhen 语句实际上只有点击下一步时才被执行\NOK, the MapWhen is actually only executed when it comes down and hits that during configuration.
Dialogue: 0,0:13:35.79,0:13:41.73,Default,,0,0,0,,当应用程序启动时，对吧，当这个配置启动后，就会对其进行调试\Nwhen the application is starting up basically. Right! When this configuration has that startup， has debug them
Dialogue: 0,0:13:41.76,0:13:44.49,Default,,0,0,0,,因为它不会显示每个请求，完全正确！\Nbecause it doesn't show per request. Exactly!
Dialogue: 0,0:13:44.70,0:13:48.90,Default,,0,0,0,,让我在这个我要点击的这个地方放一个调试点，\NSo let me put a debug point in this one that I'm hitting,
Dialogue: 0,0:13:49.50,0:13:52.30,Default,,0,0,0,,好的，现在我可以检查一下这个header\NOK， and now I can inspect and take a look at that header
Dialogue: 0,0:13:52.53,0:13:54.57,Default,,0,0,0,,现在让我开始我的中间件示例。\Nso now let me start my middleware sample.
Dialogue: 0,0:13:54.78,0:13:56.82,Default,,0,0,0,,这次我要用Chrome来浏览。\Nand I'm going browse to it this time with Chrome.
Dialogue: 0,0:13:57.06,0:13:59.70,Default,,0,0,0,,所以我可以看一看这里发生了什么。\NSo I can take a look and see what's going on here.
Dialogue: 0,0:14:00.10,0:14:02.20,Default,,0,0,0,,好吧，只是用稍微不同的视角。\NOK, Just with the slightly different perspective.
Dialogue: 0,0:14:02.52,0:14:05.55,Default,,0,0,0,,现在我在 MapWhen上点了个断点\Nsee now I hit the breakpoint on my MapWhen statement
Dialogue: 0,0:14:05.80,0:14:11.70,Default,,0,0,0,,因为我在配置它实际的Firefox路径还没有被触发，\Nbecause I'm configuring it the actual Firefox route isn't triggered yet,
Dialogue: 0,0:14:11.70,0:14:15.30,Default,,0,0,0,,好的，我点击继续，它会逐步完成\Nalright. So I will click continue and it steps through
Dialogue: 0,0:14:15.90,0:14:23.60,Default,,0,0,0,,现在因为它在请求它，我在这里打断了检查响应类型行\Nand now because it's requesting it， I'm breaking at the actual lines here where I'm checking the response type
Dialogue: 0,0:14:24.50,0:14:29.80,Default,,0,0,0,,现在让我们检查一下User-Agent header\NSo now let's check my User-Agent header
Dialogue: 0,0:14:30.00,0:14:33.20,Default,,0,0,0,,如果我找到出错的地方\Nso if I look at oops wrong place
Dialogue: 0,0:14:33.30,0:14:39.60,Default,,0,0,0,,Context. Requests. Headers。一旦你输入了这个，你就可以放大\NContext. Requests. Headers. And once you type this you can zoom in right.
Dialogue: 0,0:14:39.90,0:14:49.90,Default,,0,0,0,,好的，让我展示一下，看看这个\Nyes， let me do that in just a few seconds and I show that ，check this out
Dialogue: 0,0:14:49.90,0:14:52.40,Default,,0,0,0,,标题实际上是一个集合。\NThe headers is actually a collection.
Dialogue: 0,0:14:52.70,0:14:55.20,Default,,0,0,0,,哦，我需要看一下集合中的第一项\Noh, so I need to look at the first item in the collection
Dialogue: 0,0:14:55.40,0:15:03.20,Default,,0,0,0,,检查这个字符串，好的，如果我用 [0]\Nand inspect that string, alright. So if I did say [0]
Dialogue: 0,0:15:03.20,0:15:06.20,Default,,0,0,0,,跟踪，检查\Ntrack no.check it
Dialogue: 0,0:15:06.20,0:15:07.70,Default,,0,0,0,,对First()求值，\Nevaluate it for me if I said First(),
Dialogue: 0,0:15:08.00,0:15:11.50,Default,,0,0,0,,还是不要让我在这个窗口中遍历这个\Nstill not going to let me traverse that here inside this window
Dialogue: 0,0:15:11.85,0:15:13.80,Default,,0,0,0,,我来修改一下代码\Nso let me fix my code here
Dialogue: 0,0:15:14.60,0:15:17.60,Default,,0,0,0,,因此，我将把它改为First（）。包含（“Firefox”）\Nso I will change this to say First( ).Contains("Firefox")
Dialogue: 0,0:15:20.70,0:15:23.70,Default,,0,0,0,,然后我们会切换到火狐浏览器\Nthen we'll route over to my firefox rout
Dialogue: 0,0:15:24.20,0:15:25.50,Default,,0,0,0,,有道理。\NMakes sense OK.
Dialogue: 0,0:15:25.50,0:15:33.00,Default,,0,0,0,,让我重新运行一次\NSo let me rerun this one more time
Dialogue: 0,0:15:33.00,0:15:36.30,Default,,0,0,0,,你是在Chrome中运行还是选择你的浏览器\Nand are you running in Chrome or I guess you can pick your browser
Dialogue: 0,0:15:36.30,0:15:37.80,Default,,0,0,0,,让我从chrome开始，好的\NLet me start in chrome. Okay
Dialogue: 0,0:15:38.60,0:15:42.70,Default,,0,0,0,,现在这是在运行，我停在 Hello World！这里\Nso now this is running and I'm stopped here at my Hello World!
Dialogue: 0,0:15:44.50,0:15:49.50,Default,,0,0,0,,在Chrome的内部，我得到了Hello World！\Nand that runs in inside of Chrome, I get Hello World!
Dialogue: 0,0:15:49.80,0:15:52.40,Default,,0,0,0,,好的，让我回到火狐浏览器\NOkay. Let me go back over to Firefox
Dialogue: 0,0:15:52.90,0:15:55.70,Default,,0,0,0,,我将请求那个位置，然后我得到了Hello Firefox。\Nand I'll request that location and I get Hello Firefox.
Dialogue: 0,0:15:55.70,0:15:56.50,Default,,0,0,0,,哦，太好了！\Noh nice !
Dialogue: 0,0:15:56.61,0:15:56.94,Default,,0,0,0,,好的\Nokay
Dialogue: 0,0:15:57.06,0:16:00.03,Default,,0,0,0,,我通过检查用户代理字符串来检测浏览器\Nso I've detected the browser by checking the user agent string
Dialogue: 0,0:16:00.20,0:16:04.80,Default,,0,0,0,,我已经映射过了，已经在中间件中处理过这些\Nand I've mapped I've said go do this instead inside of my middleware
Dialogue: 0,0:16:04.80,0:16:08.00,Default,,0,0,0,,好的，还有我见过一些比这更大的图片\NOkay so some bigger picture things that I'm seeing out of this one
Dialogue: 0,0:16:08.20,0:16:14.20,Default,,0,0,0,,你这样做是基于头的，所以在这个例子中你可以检测user agent，你可以检测任何类型的header\Nyou did that based on headers. so in this case you were detecting the user agent ， but you could detect any kind of header there
Dialogue: 0,0:16:14.20,0:16:16.10,Default,,0,0,0,,当然，所有关于请求的内容\Nabsolutely, anything else about the request
Dialogue: 0,0:16:16.20,0:16:21.20,Default,,0,0,0,,另一件我认为很酷的事情是我们不应该交叉的，那就是你可以调试它们。\Nanother thing that I think is really cool that we shouldn't like just cross ever is that you can debug them.
Dialogue: 0,0:16:21.42,0:16:26.16,Default,,0,0,0,,这实际上是一些代码，你可以进入，你可以设置断点，你可以与它们交互。\Nso this is actually bits of code and you can go in and you can set break points and you can interact with them.
Dialogue: 0,0:16:26.30,0:16:32.70,Default,,0,0,0,,你也可以是有条件的东西比如，如果我在开发中如果我是对的，不管它是什么\Nyou could also is that conditional things that say if I'm in development do this if I'm right and this whatever it is write
Dialogue: 0,0:16:32.70,0:16:33.20,Default,,0,0,0,,当然\Nabsolutely
Dialogue: 0,0:16:33.30,0:16:35.10,Default,,0,0,0,,让我们实际写一下\Nso let's do that, let's actually write
Dialogue: 0,0:16:35.30,0:16:41.20,Default,,0,0,0,,把我们的例子再进一步讲一讲，我要停止这个\Ntake our sample here one step further I'm going to stop this and
Dialogue: 0,0:16:41.20,0:16:44.60,Default,,0,0,0,,让我们把这些移到另一个类中\Nlet's actually move some of this out into another class
Dialogue: 0,0:16:45.00,0:16:52.90,Default,,0,0,0,,看看我们如何使用相同类型的方法来使用静态文件，\Nand and see how we can use that same type of the way we get the use static files,
Dialogue: 0,0:16:52.90,0:17:02.40,Default,,0,0,0,,让我们看看，我们是否可以在这里快速构建语法，围绕我们为环境信息所做的一些信息\Nlet's see if we can build that syntax here pretty quickly around some of that information we're doing for our environment information
Dialogue: 0,0:17:02.97,0:17:05.52,Default,,0,0,0,,所以我能做的是，我可以在这里写另一个类\NSo what I can do is I can write another class here
Dialogue: 0,0:17:06.70,0:17:12.30,Default,,0,0,0,,我把它命名为 EnvironmentMiddleware.\Nand I will call it EnvironmentMiddleware.
Dialogue: 0,0:17:12.40,0:17:18.80,Default,,0,0,0,,让我们开始创建一个类，public class EnvironmentMiddleware\NSo let's start creating a class here, public class EnvironmentMiddleware
Dialogue: 0,0:17:18.90,0:17:23.60,Default,,0,0,0,,关于中间件的问题是它不是一个抽象类或者你正在实现的接口\Nnow the thing about middleware is it's not an abstract class or an interface that you're implementing
Dialogue: 0,0:17:24.10,0:17:29.30,Default,,0,0,0,,你实际上实现了一个很重要的调用方法\Nyou're actually implementing one method that's important and that's the invoke method
Dialogue: 0,0:17:29.30,0:17:33.60,Default,,0,0,0,,让我们创建public async Task Invoke\NSo let's create public async Task Invoke
Dialogue: 0,0:17:34.30,0:17:38.80,Default,,0,0,0,,Invoke接受一个HTTP上下文我们把它命名为context\Nand Invoke takes an HTTP context and we'll just call it context
Dialogue: 0,0:17:39.90,0:17:41.88,Default,,0,0,0,,我要把我的缩放移到这里。\NI'm going to move my zoom here.
Dialogue: 0,0:17:43.74,0:17:44.10,Default,,0,0,0,,再见\Ngood bye
Dialogue: 0,0:17:44.90,0:17:49.10,Default,,0,0,0,,现在对于我的环境，我记录环境信息的方式\NNow for my environment the way I was logging information about the environment
Dialogue: 0,0:17:49.20,0:17:56.80,Default,,0,0,0,,我想在管道和托管环境中传递下一个委托的信息\NI want to pass in information about the next delegate is coming along in the pipeline and the hosting environment
Dialogue: 0,0:17:56.80,0:18:00.80,Default,,0,0,0,,让我用ctor片段创建一个构造函数\NSo let me create a constructor using the ctor snippet
Dialogue: 0,0:18:01.30,0:18:07.50,Default,,0,0,0,,我将接收到RequestDelegate，通常叫做是next\Nand I will receive the RequestDelegate. typically called next by convention
Dialogue: 0,0:18:07.90,0:18:11.70,Default,,0,0,0,,然后是关于托管环境的信息\Nand then information about the hosting environment that were operating in
Dialogue: 0,0:18:12.00,0:18:18.40,Default,,0,0,0,,让我把下一个委托保存到一个私有字段中\Nso let me save that next delegate into a private field here
Dialogue: 0,0:18:18.78,0:18:20.73,Default,,0,0,0,,我将为它创建一个只读字段\NI'll create a read only field for that
Dialogue: 0,0:18:21.50,0:18:27.60,Default,,0,0,0,,然后把我的环境信息保存到另一个只读字段中\Nand then I'll save off my environment information into another read only field
Dialogue: 0,0:18:28.53,0:18:28.95,Default,,0,0,0,,Cool\NCool
Dialogue: 0,0:18:30.00,0:18:34.30,Default,,0,0,0,,在我的调用中，我可以做几乎和我之前做的一样的事情\NNow inside of my Invoke I can do almost the exact same things I was doing before
Dialogue: 0,0:18:35.10,0:18:43.10,Default,,0,0,0,,在这个方法中，我直接把它复制粘贴到这里，\Nhere in this method so let me just copy this directly and paste it in here now,
Dialogue: 0,0:18:44.20,0:18:48.50,Default,,0,0,0,,我没有那个日志记录器\NI don't have that logger available to me
Dialogue: 0,0:18:48.50,0:18:59.90,Default,,0,0,0,,让我们稍微改变一下让它对那些没有访问它的人更有互动性并且能够看到日志\Nso let's change this just a little bit and make it a little bit more interactive for folks that aren't accessing this from and being able to see the log
Dialogue: 0,0:19:00.20,0:19:07.10,Default,,0,0,0,,我可以这样写  context Response.Headers.Add\NI can say something like context Response.Headers.Add
Dialogue: 0,0:19:07.60,0:19:13.80,Default,,0,0,0,,然后让我添加关于我的HostingEnvironmentName的信息\Nand then let me add information about my HostingEnvironmentName
Dialogue: 0,0:19:14.60,0:19:16.70,Default,,0,0,0,,这是一个字符串的集合。\Nand then that's a collection of strings.
Dialogue: 0,0:19:17.20,0:19:20.40,Default,,0,0,0,,所以，是的，新的字符串值我要做的\NSo yep new string values what I'm going to do
Dialogue: 0,0:19:21.80,0:19:26.50,Default,,0,0,0,,一个匿名类型和and EnvironmentName\Nan anonymous type there and EnvironmentName
Dialogue: 0,0:19:27.40,0:19:31.10,Default,,0,0,0,,好了，我只是把环境名添加到一个新标题中\Nall right so I'm just adding that environment name as a new header
Dialogue: 0,0:19:31.30,0:19:34.60,Default,,0,0,0,,自定义标头这就是为什么这里有X\Nthe custom header that's why has that X there
Dialogue: 0,0:19:34.60,0:19:40.30,Default,,0,0,0,,接下来是这个，我没有logger\Nand next it's this now I don't have a logger
Dialogue: 0,0:19:40.70,0:19:46.60,Default,,0,0,0,,但如果我能做到，那岂不是太好了\Nbut wouldn't it be great if I could
Dialogue: 0,0:19:46.90,0:19:49.70,Default,,0,0,0,,哦，我还没有把context传给下一个请求\Noops! I haven't pass in the context to my next request
Dialogue: 0,0:19:49.70,0:19:50.20,Default,,0,0,0,,我们需要把它传递下去\Nwe need to pass that on
Dialogue: 0,0:19:50.20,0:19:50.50,Default,,0,0,0,,是的\Nyeah
Dialogue: 0,0:19:50.50,0:19:56.10,Default,,0,0,0,,所以在这条线上的下一个人可以接收并与之互动\Nso that the next folks in the line that are listening can receive and interact with that
Dialogue: 0,0:19:56.10,0:19:56.97,Default,,0,0,0,,因为我没有把它写在日志上\NSince I'm not putting this on the log
Dialogue: 0,0:19:59.73,0:20:02.04,Default,,0,0,0,,我想把它放到一个页面上如果它是html\NI want to put this on a page if it's html
Dialogue: 0,0:20:02.70,0:20:03.10,Default,,0,0,0,,我们来快速检查一下\NSo let's just do a quick check and say
Dialogue: 0,0:20:03.10,0:20:03.12,Default,,0,0,0,,让我们快速地说一下\Nlet's just do a quick track and say\N我们来快速检查一下\NSo let's just do a quick check and say
Dialogue: 0,0:20:03.12,0:20:05.10,Default,,0,0,0,,让我们快速地说一下\Nlet's just do a quick track and say
Dialogue: 0,0:20:08.50,0:20:13.90,Default,,0,0,0,,如果我的Environment ==development\Nif my  Environment Name equals development
Dialogue: 0,0:20:14.00,0:20:18.10,Default,,0,0,0,,是的，我也可以通过说ISDevelopment来做到这一点\Nright and I can also do that by saying ISDevelopment
Dialogue: 0,0:20:18.10,0:20:28.50,Default,,0,0,0,,好的，我的context.Response.ContentType==text/html\Nokay， and my context.Response.ContentType equals text/html
Dialogue: 0,0:20:29.40,0:20:37.20,Default,,0,0,0,,哦，我们还需要确保ContentType不是空的\NOh! we also need to make sure that ContentType isn't null
Dialogue: 0,0:20:38.10,0:20:40.40,Default,,0,0,0,,我把它格式化一下\NSo let me format that a little bit
Dialogue: 0,0:20:41.90,0:20:45.00,Default,,0,0,0,,好的，如果它不是空的，如果它是text/html\NAlright, so if it's not null if it is text/html
Dialogue: 0,0:20:45.00,0:20:54.80,Default,,0,0,0,,我们把它写出来让我们在HTML的结尾写上context.Response.writeAsync\Nwe're writing out then let's add on to the end of our HTML by saying context.Response.writeAsync
Dialogue: 0,0:20:54.90,0:21:17.70,Default,,0,0,0,,我将添加一个段落，其中有一些字符串插值，From ｛Env_｝EnvironmentName｝ in ｛timer ElapsedMilliseconds｝\Nand I'll just add a paragraph with some string interpolation that says from EnvironmentName in and then let's complete my timer ElapsedMilliseconds.
Dialogue: 0,0:21:17.70,0:21:17.90,Default,,0,0,0,,这很酷，所以你要修改一个html响应\Nthis is really cool so you are modifying an html response
Dialogue: 0,0:21:17.94,0:21:20.01,Default,,0,0,0,,是的，通过编写一些自定义中间件\Nyes  by writing a little bit of custom middleware
Dialogue: 0,0:21:20.10,0:21:20.82,Default,,0,0,0,,当然\Nabsolutely
Dialogue: 0,0:21:21.40,0:21:23.90,Default,,0,0,0,,好了，我已经把它写在这里了\NAlright so I've written that into the mix here
Dialogue: 0,0:21:25.10,0:21:28.50,Default,,0,0,0,,这是一个异步调用所以我们应该等待它\Nthat's an async call so we should await it
Dialogue: 0,0:21:28.50,0:21:32.50,Default,,0,0,0,,好了，就是这样，这就触发了\Nthere we go and that's it. So this is going to trigger
Dialogue: 0,0:21:32.60,0:21:34.70,Default,,0,0,0,,在这之后，\Nafter this next statement,
Dialogue: 0,0:21:34.70,0:21:35.20,Default,,0,0,0,,好吧\Nall right
Dialogue: 0,0:21:35.90,0:21:43.10,Default,,0,0,0,,让我重新运行一次\NSo let me rerun this one more time
Dialogue: 0,0:21:43.10,0:21:45.30,Default,,0,0,0,,我将在chrome中运行这个\Nand I'll run this in chrome
Dialogue: 0,0:21:46.41,0:21:47.67,Default,,0,0,0,,我得到了我的hello world。\NI get my hello world.
Dialogue: 0,0:21:48.75,0:21:51.42,Default,,0,0,0,,现在让我们看一下我们的头信息\Nand let's take a look now at our Header Information
Dialogue: 0,0:21:51.81,0:21:52.80,Default,,0,0,0,,它又回来了。\Nthat's coming back.
Dialogue: 0,0:21:53.90,0:21:57.00,Default,,0,0,0,,当我查看本地主机时，我将进行一次刷新。\NI'll do a refresh so when I look at Localhost.
Dialogue: 0,0:22:04.20,0:22:08.20,Default,,0,0,0,,所以我还没有Header，因为我没有刷新这个页面。\NSo I don't have my Header yet, that's because I didn't hard refresh this page.
Dialogue: 0,0:22:10.17,0:22:11.76,Default,,0,0,0,,它仍然在寻找缓存的内容\NIt's still looking at what's cached
Dialogue: 0,0:22:12.27,0:22:13.89,Default,,0,0,0,,所以我要点击本地主机\Nso I'll click back on local host
Dialogue: 0,0:22:14.90,0:22:18.90,Default,,0,0,0,,现在，它还没有出来，\Nand now， it's not coming out,
Dialogue: 0,0:22:19.17,0:22:21.21,Default,,0,0,0,,我写了所有的类为什么它不出来\NI wrote all that class why isn't it coming out
Dialogue: 0,0:22:21.51,0:22:23.19,Default,,0,0,0,,你需要把它添加到管道中\Nyou actually have to add it into the pipeline
Dialogue: 0,0:22:23.25,0:22:24.24,Default,,0,0,0,,哈哈\Nnow ha ha.
Dialogue: 0,0:22:27.10,0:22:30.70,Default,,0,0,0,,我们如何将它添加到管道中，我们有这个use语句\Nso how we add that into the pipeline， well， we have this using statement
Dialogue: 0,0:22:32.58,0:22:33.00,Default,,0,0,0,,这里的使用语句\Nthis use statement here
Dialogue: 0,0:22:34.10,0:22:38.30,Default,,0,0,0,,这是垃圾，我们把它移到了别处，我们可以用app.UseMiddleware\Nthat's trash now we've moved it somewhere else， we can say app. UseMiddleware
Dialogue: 0,0:22:39.60,0:22:41.90,Default,,0,0,0,,然后我想把它变成泛型类型\Nand then I like to pass into generic type here yeah
Dialogue: 0,0:22:42.09,0:22:42.39,Default,,0,0,0,,请说\Nyep
Dialogue: 0,0:22:42.80,0:22:44.30,Default,,0,0,0,,EnvironmentMiddleware\NEnvironmentMiddleware
Dialogue: 0,0:22:45.39,0:22:45.66,Default,,0,0,0,,好的\Nokay
Dialogue: 0,0:22:46.62,0:22:48.06,Default,,0,0,0,,好的，那么通过这个语句\Nokay. So with that statement
Dialogue: 0,0:22:48.12,0:22:48.99,Default,,0,0,0,,让我们重新运行。\Nlet's rerun.
Dialogue: 0,0:22:49.20,0:22:53.10,Default,,0,0,0,,这是我们的管道它被调用了，它被引用了\Nand now that's in our pipeline it's being called， it's being referenced
Dialogue: 0,0:22:53.40,0:22:58.40,Default,,0,0,0,,当我们工作的时候，它打印了From Development in 22ms\Nas we work through and now it says From Development in 22ms
Dialogue: 0,0:22:58.40,0:23:01.90,Default,,0,0,0,,如果我看一下我的请求\Nand if I look at my requests
Dialogue: 0,0:23:02.90,0:23:06.70,Default,,0,0,0,,这是我的header X-EnvironmentName,.Development\Nthere is my Header X-EnvironmentName,.Development.
Dialogue: 0,0:23:06.70,0:23:07.90,Default,,0,0,0,,它为我写了出来\Nand its written out for me
Dialogue: 0,0:23:08.23,0:23:10.45,Default,,0,0,0,,它也被写进了这个HTML页面。\Nand it's also written into this HTML page.
Dialogue: 0,0:23:10.80,0:23:15.90,Default,,0,0,0,,它也没有写在这里\NIt's also not being written over here
Dialogue: 0,0:23:16.20,0:23:25.30,Default,,0,0,0,,我们的页面中发生的是，是的，中间件正在被调用但是静态文件被清除了\Nwhat's going on in our page is yes that middleware is being called but that static file clears out
Dialogue: 0,0:23:25.60,0:23:28.60,Default,,0,0,0,,只返回它的内容。\Nand only returns its Content.
Dialogue: 0,0:23:28.60,0:23:37.20,Default,,0,0,0,,所以发生的事情是回溯到或阻止\NSo the things that would have occurred， right， coming back up or blocked
Dialogue: 0,0:23:37.20,0:23:41.90,Default,,0,0,0,,因为它说我已经完成了标题的响应\Nbecause it says I'm done the response has completed that Header
Dialogue: 0,0:23:41.90,0:23:48.60,Default,,0,0,0,,在下一次调用之前，它在我的中间件中执行并包含在这里。\Nthat it executed and included over here in my middleware before the next being called.
Dialogue: 0,0:23:48.70,0:23:51.00,Default,,0,0,0,,这已经完成了\Nthis was completed
Dialogue: 0,0:23:51.20,0:23:56.60,Default,,0,0,0,,但是因为它的其他部分被阻塞了并且在它之后终止了这个代码\Nbut because the rest of it was being blocked and it terminated this code after it
Dialogue: 0,0:23:56.60,0:23:58.50,Default,,0,0,0,,明白了。\NDid not fire, got it.
Dialogue: 0,0:23:58.50,0:23:59.50,Default,,0,0,0,,理解了，是的\Nmake sense. yeah
Dialogue: 0,0:23:59.80,0:24:05.10,Default,,0,0,0,,好了，现在让我们做最后一件事，这样我们就可以得到与使用静态文件相同的语法\NAll Right ,So now let's do one last thing just so we can get that same syntax we had with the use static files
Dialogue: 0,0:24:05.40,0:24:10.10,Default,,0,0,0,,让我们在一个静态类中放入一个快速助手方法。\Nlet's just put a quick helper method inside of a Static Class.
Dialogue: 0,0:24:10.10,0:24:12.00,Default,,0,0,0,,让我猜猜你接下来要做什么\NSo let me  guess what you're going do here well
Dialogue: 0,0:24:12.00,0:24:14.00,Default,,0,0,0,,我在这里讲话的时候让你打字\Nso let you type while I talk here, sure
Dialogue: 0,0:24:14.80,0:24:20.40,Default,,0,0,0,,当然可以，你会输入app.usemiddleware并给他个名称，这都很好\Nsure go for it， You had to go in and you have to say app.UseMiddleware  and you had to give it the Generic Name which is OK
Dialogue: 0,0:24:20.40,0:24:23.20,Default,,0,0,0,,但它有点烦躁\Nbut it's it's a little bit fidgety
Dialogue: 0,0:24:23.20,0:24:26.00,Default,,0,0,0,,它不像我在其他中间件上看到的那样好和有经验。\Nandit's not as nice and experienced as I see with the other Middleware.
Dialogue: 0,0:24:26.00,0:24:30.10,Default,,0,0,0,,我把它连接到App.UseMVC，它自动为我完成，是的！\NI'm wiring up where I say App.Use MVC and it autocompletes for me, yep!
Dialogue: 0,0:24:30.19,0:24:31.00,Default,,0,0,0,,是的，你是对的\Nyep you're right
Dialogue: 0,0:24:31.00,0:24:34.70,Default,,0,0,0,,如果我传递自定义参数\Nand  if I was passing in custom parameters
Dialogue: 0,0:24:34.70,0:24:37.60,Default,,0,0,0,,如果我需要传递很多东西来配置它\Nas well if I had to pass in a lot of stuff to configure that
Dialogue: 0,0:24:37.60,0:24:43.50,Default,,0,0,0,,这也是我想要的方法签名，你可以帮我做一些工作让它更简单\Nthat also that method signature I might want ，you to do some work for me to make it Easier
Dialogue: 0,0:24:43.54,0:24:45.79,Default,,0,0,0,,给我一些信息让它自动完成\NGive me some Intelligence make it autocomplete
Dialogue: 0,0:24:45.90,0:24:54.00,Default,,0,0,0,,好的，我要把同样的 UseMiddleware EnvironmentMiddleware 提取出来\Nright，So I'm just going to lift that same UseMiddleware EnvironmentMiddleware Statement
Dialogue: 0,0:24:54.52,0:24:56.20,Default,,0,0,0,,然后嵌入到这里\Nand just embedded over here
Dialogue: 0,0:24:56.30,0:25:01.20,Default,,0,0,0,,这样我就可以在这里用一些其他代码来设置这个中间件。\NSo that I could put any other code I need to use to set up that middleware right here.
Dialogue: 0,0:25:01.30,0:25:07.30,Default,,0,0,0,,所以现在在你的startup中，你可以用app.Use来替换那些app.UseMiddleware的代码。\Nso now in your startup you can replace that code that says UseMiddleware with app.Use EnvironmentMiddleware.
Dialogue: 0,0:25:07.84,0:25:08.29,Default,,0,0,0,,好了\NThere you go
Dialogue: 0,0:25:09.67,0:25:10.93,Default,,0,0,0,,是的，它仍然有效。\Nyeah it'll still work.
Dialogue: 0,0:25:11.50,0:25:20.20,Default,,0,0,0,,我将运行程序，Hello World！  From development in 24 MS\Nso I'll start with the Application. Hello World!
Dialogue: 0,0:25:20.68,0:25:21.31,Default,,0,0,0,,很酷。\Nvery cool.
Dialogue: 0,0:25:21.64,0:25:24.40,Default,,0,0,0,,这是关于如何编写自定义中间件的。\NSo that's a little bit about how to write Custom Middleware.
Dialogue: 0,0:25:25.03,0:25:28.12,Default,,0,0,0,,我知道ASP.NET提供了一些示例\NI know the ASP.NET folks have some samples out there for us
Dialogue: 0,0:25:28.40,0:25:34.30,Default,,0,0,0,,是的，我只是想展示一些例子当你想要写你自己的自定义中间件时\Nyeah I just wanted to show some examples there as you want to as you dig into writing your own Custom Middleware
Dialogue: 0,0:25:34.63,0:25:38.02,Default,,0,0,0,,看到一些生产中间件真的很有帮助\Nit's really helpful to see some production Shipping Middleware
Dialogue: 0,0:25:38.20,0:25:41.50,Default,,0,0,0,,幸运的是，所有这些中间件都在Github上。\Nfortunately all this Middleware is out on Github.
Dialogue: 0,0:25:41.89,0:25:44.89,Default,,0,0,0,,这里我看到的是基本中间件repo\NSo here I'm looking in the BasicMiddleware repo
Dialogue: 0,0:25:45.30,0:25:47.00,Default,,0,0,0,,他们在这里有好几个好东西\Nand they've got several good things in here
Dialogue: 0,0:25:49.40,0:25:55.30,Default,,0,0,0,,他们有些项目，比如zipping，你的结果中压缩的东西。\Nthey've got ones for like zipping for all kinds of you know for compress in your results.
Dialogue: 0,0:25:55.40,0:26:01.70,Default,,0,0,0,,是的，我想在这里展示的是Rewrite 中间件\NYeah! The one I want to show here is the the Rewrite of middleware,
Dialogue: 0,0:26:01.70,0:26:07.00,Default,,0,0,0,,这个的简洁之处就在于它允许，你知道的，这是mod Rewrite\Nwhat's neat about this is this allows for. you know, there's the mod Rewrite
Dialogue: 0,0:26:07.00,0:26:09.90,Default,,0,0,0,,您可以在您的HT Access文件中放入RewriteRules\Nthe RewriteRules you can put in your HT Access Files.
Dialogue: 0,0:26:10.00,0:26:14.90,Default,,0,0,0,,如果你在Apache上使用过，这是一种常见的语法。\NIf you've used like on Apache and it's kind of a Common Syntax.
Dialogue: 0,0:26:14.90,0:26:17.20,Default,,0,0,0,,他们在这里所做的一切我认为非常平滑\NSo what they've done here which i think is really slick
Dialogue: 0,0:26:17.56,0:26:19.90,Default,,0,0,0,,他们已经创建了一些自定义中间件\Nis they have created some custom middleware
Dialogue: 0,0:26:20.10,0:26:27.90,Default,,0,0,0,,这将在ASP.NET core中解析这些Rewrite，因此Kestrel将会理解\Nthat will parse these and and Rewrite in ASP.NET core. So that Kestrel will now understand
Dialogue: 0,0:26:27.90,0:26:31.00,Default,,0,0,0,,我们在Apache上使用的规则也很酷！\Nthe same rules that we were using on Apache exactly cool!
Dialogue: 0,0:26:31.80,0:26:33.00,Default,,0,0,0,,这是相当平滑的。\Nwhich is Pretty Slick.
Dialogue: 0,0:26:33.10,0:26:37.30,Default,,0,0,0,,所以在这里它能够真正地理解这些是否只是 RewriteRules\Nso here it's able to actually understand if these are just  RewriteRules.
Dialogue: 0,0:26:37.40,0:26:40.90,Default,,0,0,0,,你知道它是文本，它也理解一些\NYou know it is text， it also understands some
Dialogue: 0,0:26:40.90,0:26:42.60,Default,,0,0,0,,这是他们的示例\Nthis is their sample here showing.
Dialogue: 0,0:26:43.00,0:26:46.00,Default,,0,0,0,,你可以添加这些 Rewrites\Nyou can add these Rewrites in
Dialogue: 0,0:26:46.00,0:26:49.80,Default,,0,0,0,,您也可以在这里配置它们，这是非常酷的！\Nyou can also configure them here in line which is Pretty mean cooll!
Dialogue: 0,0:26:50.00,0:26:54.20,Default,,0,0,0,,它了解我们过去使用的IISRewriteRules\NAnd it understands the IISRewriteRules that we used to use
Dialogue: 0,0:26:54.40,0:26:56.90,Default,,0,0,0,,很好，所以它也把这些都拉进来\Nexactly okay. So it pulls those in as well
Dialogue: 0,0:26:56.90,0:27:02.60,Default,,0,0,0,,如果你看一下Rewrite中间件，它本身就是一段代码\Nand if you look in at the Rewrite middleware itself it's a bit of code
Dialogue: 0,0:27:02.74,0:27:04.30,Default,,0,0,0,,但这并不疯狂\Nbut it's not crazy
Dialogue: 0,0:27:04.30,0:27:04.33,Default,,0,0,0,,就像你知道的，它不是成百上千行代码。\Nlike it's you know it's not hundreds and hundreds of lines of code.\N但这并不疯狂\Nbut it's not crazy
Dialogue: 0,0:27:04.33,0:27:08.20,Default,,0,0,0,,就像你知道的，它不是成百上千行代码。\Nlike it's you know it's not hundreds and hundreds of lines of code.
Dialogue: 0,0:27:08.20,0:27:14.00,Default,,0,0,0,,它是另一个类，然后从一个请求委托开始，就像我们在我的EnvironmentMiddleware中间件中看到的一样\NIt's another class， then starts off with a request delegate next just like we saw in my EnvironmentMiddleware
Dialogue: 0,0:27:14.70,0:27:18.80,Default,,0,0,0,,它也包含了些其他的东西比如传入 logger\Nexactly it's taking in a few other things too like passing in a logger
Dialogue: 0,0:27:18.80,0:27:19.80,Default,,0,0,0,,以及选项和内容\Nand options and stuff
Dialogue: 0,0:27:20.38,0:27:24.25,Default,,0,0,0,,但是在这里，他们设置了下一个选项和你做的选择是一样的\NBut then it's for in here they set next and options just the same kind of as you did
Dialogue: 0,0:27:24.50,0:27:28.50,Default,,0,0,0,,然后调用就在这里我的意思是它是几行代码\Nand then they're invoke is there just I mean it's  a few lines of code
Dialogue: 0,0:27:29.40,0:27:34.40,Default,,0,0,0,,但它不是我的，（不是压倒性的）所以这里他们只是在迭代他的规则和应用规则\NBut it's not mine bars ,(not overwhelming) and so here they're just iterating  he Rules and Applying the rules
Dialogue: 0,0:27:34.40,0:27:43.20,Default,,0,0,0,,这就是最后的结果，就像你做的那样，他们然后返回了下一个、 传入联系人和委托\Nand so That's really and then at the end just as you did they returned next and pass the contacts and the delegate,
Dialogue: 0,0:27:43.40,0:27:47.80,Default,,0,0,0,,非常酷，然后他们也写了这些扩展方法。\Nso really cool and then they  also wrote these Extension Methods.
Dialogue: 0,0:27:47.80,0:27:52.50,Default,,0,0,0,,这样我就可以使用app。这里我用 app.UseRewriter\NSo that I can use app.Use here I do app.UseRewriter
Dialogue: 0,0:27:52.50,0:28:00.80,Default,,0,0,0,,所以我认为这是一种很好的方式正如你们想要继续的那样,你可能正在写一些超出我们今天所展示的内容的东西\Nso I just I think this is a great like as you want to go on as you maybe are writing something that's a little bit beyond  what you have shown us today
Dialogue: 0,0:28:01.10,0:28:02.10,Default,,0,0,0,,这里有一些很棒的示例\Nhere's some great samples
Dialogue: 0,0:28:02.10,0:28:03.90,Default,,0,0,0,,以及关于如何做到这一点的信息。\Nand information about how to do that.
Dialogue: 0,0:28:04.10,0:28:09.00,Default,,0,0,0,,我想指出的另一个地方是中间件上的文档是非常全面的\None other place I want to point you to is the docs on middleware are pretty comprehensive
Dialogue: 0,0:28:09.00,0:28:12.40,Default,,0,0,0,,他们有一些很好的图表解释，你知道的\Nthey've got some great diagrams explaining，you know exactly
Dialogue: 0,0:28:12.40,0:28:20.50,Default,,0,0,0,,中间件如何工作，以及如何工作和解释关于编写您自己的自定义中间件的所有事情，太棒了！\Nhow middleware works and how pass-through works and explaining all kinds of things about writing your own custom middleware， terrific!
Dialogue: 0,0:28:20.50,0:28:23.70,Default,,0,0,0,,好了，我们在这个视频中学习了很多关于中间件的知识\NAlright, so we learned a lot about middleware here in this video
Dialogue: 0,0:28:23.90,0:28:27.60,Default,,0,0,0,,了解了如何配置它，为什么它的顺序是重要的。\Nlearned about how to configure it， why the order of it is important.
Dialogue: 0,0:28:27.60,0:28:31.70,Default,,0,0,0,,我们看到了如何让我们的在外部类中写入中间件\NWe saw how we can take our middleware write it in an external class
Dialogue: 0,0:28:31.80,0:28:33.30,Default,,0,0,0,,我们可以把它写在一行上\Nwe can write it in line
Dialogue: 0,0:28:33.30,0:28:35.50,Default,,0,0,0,,我们在Github上看到了一些很棒的示例\Nwe saw some great samples on Github
Dialogue: 0,0:28:36.49,0:28:38.35,Default,,0,0,0,,非常感谢你加入我们的视频。\Nthanks so much for joining us for this video.
Dialogue: 0,0:28:38.65,0:28:41.77,Default,,0,0,0,,我们在这里使用ASP.NET Core写一些很有趣的代码。\NWe have  a lot of fun writing some code here for ASP.NET Core.
Dialogue: 0,0:28:42.01,0:28:43.36,Default,,0,0,0,,我希望你能加入我们的行列。\NI hope you join us for the next one.
